let connected = false;

const butConnect = document.getElementById('butConnect');

function toggle() {
  if (connected) {
    lbl = 'Disconnect';
    connected = false;
  } else {
    lbl = 'Connect';
    // Filter Bluetooth devices from Google company with manufacturer data bytes
    // that start with [0x01, 0x02].
    navigator.bluetooth.requestDevice({
      filters: [{
        manufacturerData: [{
          companyIdentifier: 0x0822,
        }]
      }],
      optionalServices: ['battery_service'] // Required to access service later.
    })
    .then(device => { return device.gatt.connect(); })
    .catch(error => { console.error(error); });
    connected = true;
  }
  butConnect.textContent = lbl;
}

butConnect.addEventListener('click', toggle);